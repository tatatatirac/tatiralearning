<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>Login â€” TatiraLearning</title>

<style>

body{
background:#0a0f1c;
color:white;
font-family:Inter,sans-serif;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

.container{
background:#121a2b;
padding:40px;
border-radius:12px;
width:320px;
}

h2{
margin-bottom:10px;
}

input{
width:100%;
padding:12px;
margin:10px 0;
border:none;
border-radius:8px;
outline:none;
}

input:focus{
box-shadow:0 0 0 2px #00e5ff;
}

button{
width:100%;
padding:12px;
background:#00e5ff;
border:none;
border-radius:8px;
cursor:pointer;
font-weight:bold;
margin-top:10px;
}

button:hover{
background:#00c8e0;
}

a{
color:#00e5ff;
text-decoration:none;
}

.success{
color:#00ffae;
margin-top:10px;
}

.error{
color:#ff4d4d;
margin-top:10px;
}

</style>

</head>

<body>

<div class="container">

<h2>Login</h2>

<form id="login-form">

<input
id="username"
placeholder="Username"
required
>

<input
id="password"
type="password"
placeholder="Password"
required
>

<button type="submit">
Login
</button>

<div id="message"></div>

</form>

<p style="margin-top:15px;">
No account?
<a href="signup.html">Signup</a>
</p>

</div>

<script>

const form = document.getElementById("login-form");

form.addEventListener("submit", login);

async function login(event){

event.preventDefault();

const username = document.getElementById("username").value.trim();
const password = document.getElementById("password").value.trim();

const message = document.getElementById("message");

message.innerHTML="";
message.className="";

if(!username || !password){

message.innerHTML="Please enter username and password.";
message.className="error";
return;

}

try{

const response = await fetch(
"http://127.0.0.1:8000/api/login/",
{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
username,
password
})
}
);

const data = await response.json();

if(response.ok){

// save token
localStorage.setItem("access", data.access);
localStorage.setItem("username", username);

// decode JWT
const payload = JSON.parse(atob(data.access.split('.')[1]));

localStorage.setItem("is_staff", payload.is_staff || false);
localStorage.setItem("is_superuser", payload.is_superuser || false);

message.innerHTML="Login successful.";
message.className="success";

// redirect
setTimeout(()=>{
window.location.href="index.html";
},1000);

}else{

message.innerHTML="Invalid username or password.";
message.className="error";

}

}catch(error){

message.innerHTML="Cannot connect to server.";
message.className="error";

}

}

</script>

</body>

</html>